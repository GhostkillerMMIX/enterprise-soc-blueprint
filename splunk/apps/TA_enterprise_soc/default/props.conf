# Enterprise SOC Technology Add-on props.conf
# Field extractions and source type definitions

[syslog]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_FORMAT = %b %d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 25
KV_MODE = none
EXTRACT-syslog_fields = ^(?<timestamp>\w+\s+\d+\s+\d+:\d+:\d+)\s+(?<host>\S+)\s+(?<process>[^:\[\]]+)(?:\[(?<pid>\d+)\])?:\s*(?<message>.*)

[okta:system]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_FORMAT = %Y-%m-%dT%H:%M:%S.%3N%Z
MAX_TIMESTAMP_LOOKAHEAD = 30
KV_MODE = json
EXTRACT-okta_user = "actor":\{[^}]*"alternateId":"(?<user>[^"]+)"
EXTRACT-okta_client = "client":\{[^}]*"ipAddress":"(?<src_ip>[^"]+)"
EXTRACT-okta_event = "eventType":"(?<action>[^"]+)"

[pan:traffic]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_FORMAT = %Y/%m/%d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 25
KV_MODE = none
DELIMS = ","
FIELDS = "receive_time","serial","type","subtype","time_generated","src","dest","natsrc","natdst","rule","srcuser","dstuser","app","vsys","from","to","inbound_if","outbound_if","logset","sessionid","repeatcnt","sport","dport","natsport","natdport","flags","proto","action","bytes","bytes_sent","bytes_received","packets","start","elapsed","category","seqno","actionflags","srcloc","dstloc","pkts_sent","pkts_received","session_end_reason","dg_hier_level_1","dg_hier_level_2","dg_hier_level_3","dg_hier_level_4","vsys_name","device_name","action_source","src_uuid","dest_uuid","tunnelid","imsi","monitortag","imei","parent_session_id","parent_start_time","tunnel_type","sctp_association_id","sctp_chunks","sctp_chunks_sent","sctp_chunks_received"

[zeek:conn]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = none
DELIMS = "\t"
FIELDS = "ts","uid","id.orig_h","id.orig_p","id.resp_h","id.resp_p","proto","service","duration","orig_bytes","resp_bytes","conn_state","local_orig","local_resp","missed_bytes","history","orig_pkts","orig_ip_bytes","resp_pkts","resp_ip_bytes","tunnel_parents"

[zeek:dns]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = none
DELIMS = "\t"
FIELDS = "ts","uid","id.orig_h","id.orig_p","id.resp_h","id.resp_p","proto","trans_id","rtt","query","qclass","qclass_name","qtype","qtype_name","rcode","rcode_name","AA","TC","RD","RA","Z","answers","TTLs","rejected"

[zeek:http]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_FORMAT = %s.%6N
MAX_TIMESTAMP_LOOKAHEAD = 20
KV_MODE = none
DELIMS = "\t"
FIELDS = "ts","uid","id.orig_h","id.orig_p","id.resp_h","id.resp_p","trans_depth","method","host","uri","referrer","version","user_agent","origin","request_body_len","response_body_len","status_code","status_msg","info_code","info_msg","tags","username","password","proxied","orig_fuids","orig_filenames","orig_mime_types","resp_fuids","resp_filenames","resp_mime_types"

[aws:cloudtrail]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_FORMAT = %Y-%m-%dT%H:%M:%SZ
MAX_TIMESTAMP_LOOKAHEAD = 25
KV_MODE = json
EXTRACT-aws_user = "userIdentity":\{[^}]*"userName":"(?<user>[^"]+)"
EXTRACT-aws_source_ip = "sourceIPAddress":"(?<src_ip>[^"]+)"
EXTRACT-aws_event = "eventName":"(?<action>[^"]+)"
EXTRACT-aws_region = "awsRegion":"(?<region>[^"]+)"

[wineventlog:security]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TIME_FORMAT = %Y-%m-%d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 25
KV_MODE = xml
EXTRACT-win_user = <Data Name="TargetUserName">(?<user>[^<]+)</Data>
EXTRACT-win_domain = <Data Name="TargetDomainName">(?<domain>[^<]+)</Data>
EXTRACT-win_logon_type = <Data Name="LogonType">(?<logon_type>[^<]+)</Data>
EXTRACT-win_src_ip = <Data Name="IpAddress">(?<src_ip>[^<]+)</Data>
EXTRACT-win_workstation = <Data Name="WorkstationName">(?<workstation>[^<]+)</Data>

# CIM Compliance Mappings
[syslog]
EVAL-vendor_product = "Unix Syslog"
EVAL-dest = host
FIELDALIAS-syslog_time = timestamp AS _time

[okta:system]
EVAL-vendor_product = "Okta Identity Management"
FIELDALIAS-okta_src = src_ip AS src
FIELDALIAS-okta_user = user AS user
FIELDALIAS-okta_action = action AS signature

[pan:traffic]
EVAL-vendor_product = "Palo Alto Networks Firewall"
FIELDALIAS-pan_src = src AS src_ip
FIELDALIAS-pan_dest = dest AS dest_ip
FIELDALIAS-pan_action = action AS action
FIELDALIAS-pan_bytes = bytes AS bytes_in
FIELDALIAS-pan_packets = packets AS packets_in

[zeek:conn]
EVAL-vendor_product = "Zeek Network Monitor"
FIELDALIAS-zeek_src = "id.orig_h" AS src_ip
FIELDALIAS-zeek_dest = "id.resp_h" AS dest_ip
FIELDALIAS-zeek_src_port = "id.orig_p" AS src_port
FIELDALIAS-zeek_dest_port = "id.resp_p" AS dest_port
FIELDALIAS-zeek_protocol = proto AS transport
FIELDALIAS-zeek_duration = duration AS duration

[aws:cloudtrail]
EVAL-vendor_product = "AWS CloudTrail"
FIELDALIAS-aws_src = src_ip AS src
FIELDALIAS-aws_user = user AS user
FIELDALIAS-aws_action = action AS signature

[wineventlog:security]
EVAL-vendor_product = "Microsoft Windows"
FIELDALIAS-win_src = src_ip AS src
FIELDALIAS-win_user = user AS user
FIELDALIAS-win_dest = Computer AS dest
