# Splunk Indexer indexes.conf
# Generated by Ansible - Do not modify manually

# Default index settings
[default]
homePath = $SPLUNK_DB/$_index_name/db
coldPath = $SPLUNK_DB/$_index_name/colddb
thawedPath = $SPLUNK_DB/$_index_name/thaweddb
maxDataSize = {{ splunk_max_data_size }}
maxHotBuckets = {{ splunk_max_hot_buckets }}
maxWarmDBCount = {{ splunk_max_warm_db_count }}
{% if splunk_cluster_master is defined %}
repFactor = {{ splunk_replication_factor }}
{% endif %}

# Custom indexes for SOC data
{% for index in splunk_indexes %}
[{{ index.name }}]
homePath = $SPLUNK_DB/{{ index.name }}/db
coldPath = $SPLUNK_DB/{{ index.name }}/colddb
thawedPath = $SPLUNK_DB/{{ index.name }}/thaweddb
maxDataSize = {{ index.max_data_size | default(splunk_max_data_size) }}
maxHotBuckets = {{ index.max_hot_buckets | default(splunk_max_hot_buckets) }}
maxWarmDBCount = {{ index.max_warm_db_count | default(splunk_max_warm_db_count) }}
{% if splunk_cluster_master is defined %}
repFactor = {{ splunk_replication_factor }}
{% endif %}

{% endfor %}

# Summary index for scheduled searches
[summary]
homePath = $SPLUNK_DB/summary/db
coldPath = $SPLUNK_DB/summary/colddb
thawedPath = $SPLUNK_DB/summary/thaweddb
maxDataSize = auto
maxHotBuckets = 3
maxWarmDBCount = 100

# Notable events index
[notable]
homePath = $SPLUNK_DB/notable/db
coldPath = $SPLUNK_DB/notable/colddb
thawedPath = $SPLUNK_DB/notable/thaweddb
maxDataSize = auto_high_volume
maxHotBuckets = 10
maxWarmDBCount = 200

# Risk index for RBA (Risk-Based Alerting)
[risk]
homePath = $SPLUNK_DB/risk/db
coldPath = $SPLUNK_DB/risk/colddb
thawedPath = $SPLUNK_DB/risk/thaweddb
maxDataSize = auto
maxHotBuckets = 5
maxWarmDBCount = 100

# Threat intelligence index
[threat_intel]
homePath = $SPLUNK_DB/threat_intel/db
coldPath = $SPLUNK_DB/threat_intel/colddb
thawedPath = $SPLUNK_DB/threat_intel/thaweddb
maxDataSize = auto
maxHotBuckets = 3
maxWarmDBCount = 50
